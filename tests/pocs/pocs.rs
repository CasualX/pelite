use std::ops;

/*
extern crate pelite;
use std::fs;
fn main() {
	let mut blob = Vec::new();
	for e in fs::read_dir("tests/corkami").unwrap() {
		if let Ok(e) = e {
			let path = e.path();
			let bytes = fs::read(&path).unwrap();
			let range = blob.len()..blob.len() + bytes.len();
			blob.extend_from_slice(&bytes);
			println!("{}: {:?}", path.display(), range);
		}
	}
	let _ = fs::write("tests/blob", &blob);
}
*/

#[allow(dead_code)]
pub fn get(file_name: &str) -> Option<&'static [u8]> {
	match ENTRIES.binary_search_by(|poc| poc.file_name.cmp(file_name)) {
		Ok(index) => Some(&BLOB[ENTRIES[index].range.clone()]),
		Err(_) => None,
	}
}
#[allow(dead_code)]
pub fn iter() -> impl Iterator<Item = (&'static str, &'static [u8])> {
	ENTRIES.iter().map(|Entry { file_name, range }| (
		*file_name,
		&BLOB[range.clone()]
	))
}

struct Entry {
	file_name: &'static str,
	range: ops::Range<usize>,
}

static BLOB: [u8; 288134] = *include_bytes!("blob");

static ENTRIES: [Entry; 217] = [
	Entry { file_name: "96emptysections.exe", range: 0..5120 },
	Entry { file_name: "appendeddata.exe", range: 5120..6292 },
	Entry { file_name: "appendedhdr.exe", range: 6292..7604 },
	Entry { file_name: "appendedsecttbl.exe", range: 7604..8668 },
	Entry { file_name: "apphdrW7.exe", range: 8668..9980 },
	Entry { file_name: "appsectableW7.exe", range: 9980..11044 },
	Entry { file_name: "aslr-ld.exe", range: 11044..12068 },
	Entry { file_name: "aslr.dll", range: 12068..13092 },
	Entry { file_name: "bigib.exe", range: 13092..14116 },
	Entry { file_name: "bigsec.exe", range: 14116..15140 },
	Entry { file_name: "bigSoRD.exe", range: 15140..16676 },
	Entry { file_name: "bottomsecttbl.exe", range: 16676..17700 },
	Entry { file_name: "cfgbogus.exe", range: 17700..18724 },
	Entry { file_name: "compiled.exe", range: 18724..21284 },
	Entry { file_name: "copyright.exe", range: 21284..22820 },
	Entry { file_name: "ctxt-ld.exe", range: 22820..23844 },
	Entry { file_name: "ctxt.dll", range: 23844..24868 },
	Entry { file_name: "ddsect.exe", range: 24868..25892 },
	Entry { file_name: "debug.exe", range: 25892..27428 },
	Entry { file_name: "delaycorrupt.exe", range: 27428..28452 },
	Entry { file_name: "delayfake.exe", range: 28452..29476 },
	Entry { file_name: "delayimports.exe", range: 29476..30500 },
	Entry { file_name: "dep.exe", range: 30500..31524 },
	Entry { file_name: "dll-dynld.exe", range: 31524..32548 },
	Entry { file_name: "dll-dynunicld.exe", range: 32548..33572 },
	Entry { file_name: "dll-ld.exe", range: 33572..34596 },
	Entry { file_name: "dll-webdavld.exe", range: 34596..35620 },
	Entry { file_name: "dll.dll", range: 35620..36644 },
	Entry { file_name: "dllbound-ld.exe", range: 36644..37668 },
	Entry { file_name: "dllbound-redirld.exe", range: 37668..38692 },
	Entry { file_name: "dllbound-redirldXP.exe", range: 38692..39716 },
	Entry { file_name: "dllbound.dll", range: 39716..40740 },
	Entry { file_name: "dllbound2.dll", range: 40740..41764 },
	Entry { file_name: "dllcfgdup-dynld.exe", range: 41764..42788 },
	Entry { file_name: "dllcfgdup.dll", range: 42788..44324 },
	Entry { file_name: "dllemptyexp-ld.exe", range: 44324..45348 },
	Entry { file_name: "dllemptyexp.dll", range: 45348..46372 },
	Entry { file_name: "dllextep-ld.exe", range: 46372..47396 },
	Entry { file_name: "dllextep.dll", range: 47396..48420 },
	Entry { file_name: "dllfakess-dynld.exe", range: 48420..49444 },
	Entry { file_name: "dllfakess-ld.exe", range: 49444..50468 },
	Entry { file_name: "dllfakess.dll", range: 50468..51492 },
	Entry { file_name: "dllfw-ld.exe", range: 51492..52516 },
	Entry { file_name: "dllfw.dll", range: 52516..53540 },
	Entry { file_name: "dllfwloop-ld.exe", range: 53540..54564 },
	Entry { file_name: "dllfwloop.dll", range: 54564..55588 },
	Entry { file_name: "dllmaxvals-dynld.exe", range: 55588..56612 },
	Entry { file_name: "dllmaxvals-ld.exe", range: 56612..57636 },
	Entry { file_name: "dllmaxvals.dll", range: 57636..58660 },
	Entry { file_name: "dllnegep-ld.exe", range: 58660..59684 },
	Entry { file_name: "dllnegep.dll", range: 59684..60708 },
	Entry { file_name: "dllnoexp-dynld.exe", range: 60708..61732 },
	Entry { file_name: "dllnoexp.dll", range: 61732..62756 },
	Entry { file_name: "dllnomain-ld.exe", range: 62756..63780 },
	Entry { file_name: "dllnomain.dll", range: 63780..64804 },
	Entry { file_name: "dllnomain2-dynld.exe", range: 64804..65828 },
	Entry { file_name: "dllnomain2.dll", range: 65828..66852 },
	Entry { file_name: "dllnoreloc-ld.exe", range: 66852..67876 },
	Entry { file_name: "dllnoreloc.dll", range: 67876..68900 },
	Entry { file_name: "dllnullep-dynld.exe", range: 68900..69924 },
	Entry { file_name: "dllnullep-ld.exe", range: 69924..70948 },
	Entry { file_name: "dllnullep.dll", range: 70948..71972 },
	Entry { file_name: "dllord-ld.exe", range: 71972..72996 },
	Entry { file_name: "dllord.dll", range: 72996..74020 },
	Entry { file_name: "dosZMXP.exe", range: 74020..74084 },
	Entry { file_name: "dotnet20.exe", range: 74084..77156 },
	Entry { file_name: "driver.sys", range: 77156..78180 },
	Entry { file_name: "dump_imports.exe", range: 78180..79204 },
	Entry { file_name: "duphead.exe", range: 79204..81252 },
	Entry { file_name: "dupsec.exe", range: 81252..82276 },
	Entry { file_name: "d_resource-ld.exe", range: 82276..83300 },
	Entry { file_name: "d_resource.dll", range: 83300..83940 },
	Entry { file_name: "d_tiny-ld.exe", range: 83940..84964 },
	Entry { file_name: "d_tiny.dll", range: 84964..85025 },
	Entry { file_name: "exceptions.exe", range: 85025..86049 },
	Entry { file_name: "exe2pe.exe", range: 86049..88609 },
	Entry { file_name: "exportobf.exe", range: 88609..89633 },
	Entry { file_name: "exportsdata.exe", range: 89633..90657 },
	Entry { file_name: "exports_doc.exe", range: 90657..91681 },
	Entry { file_name: "exports_order.exe", range: 91681..92705 },
	Entry { file_name: "fakenet.exe", range: 92705..94241 },
	Entry { file_name: "fakeregs.exe", range: 94241..95777 },
	Entry { file_name: "fakeregslib.dll", range: 95777..96801 },
	Entry { file_name: "fakerelocs.exe", range: 96801..97825 },
	Entry { file_name: "foldedhdr.exe", range: 97825..102081 },
	Entry { file_name: "foldedhdrW7.exe", range: 102081..106337 },
	Entry { file_name: "footer.exe", range: 106337..107649 },
	Entry { file_name: "gui.exe", range: 107649..108673 },
	Entry { file_name: "hard_imports.exe", range: 108673..109697 },
	Entry { file_name: "hdrcode.exe", range: 109697..109965 },
	Entry { file_name: "hdrdata.exe", range: 109965..110989 },
	Entry { file_name: "hiddenappdata1.exe", range: 110989..112526 },
	Entry { file_name: "hiddenappdata2.exe", range: 112526..113698 },
	Entry { file_name: "ibkernel.exe", range: 113698..114722 },
	Entry { file_name: "ibkmanual.exe", range: 114722..115746 },
	Entry { file_name: "ibknoreloc64.exe", range: 115746..116770 },
	Entry { file_name: "ibnullXP.exe", range: 116770..117794 },
	Entry { file_name: "ibreloc.exe", range: 117794..121890 },
	Entry { file_name: "ibrelocW7.exe", range: 121890..125986 },
	Entry { file_name: "impbyord.exe", range: 125986..127010 },
	Entry { file_name: "imports.exe", range: 127010..128034 },
	Entry { file_name: "importsdotXP.exe", range: 128034..129058 },
	Entry { file_name: "importshint.exe", range: 129058..130082 },
	Entry { file_name: "imports_apimsW7.exe", range: 130082..131106 },
	Entry { file_name: "imports_badterm.exe", range: 131106..132130 },
	Entry { file_name: "imports_bogusIAT.exe", range: 132130..133154 },
	Entry { file_name: "imports_corruptedIAT.exe", range: 133154..134178 },
	Entry { file_name: "imports_iatindesc.exe", range: 134178..135202 },
	Entry { file_name: "imports_mixed.exe", range: 135202..136226 },
	Entry { file_name: "imports_multidesc.exe", range: 136226..137250 },
	Entry { file_name: "imports_nnIAT.exe", range: 137250..138274 },
	Entry { file_name: "imports_noext.exe", range: 138274..139298 },
	Entry { file_name: "imports_noint.exe", range: 139298..140322 },
	Entry { file_name: "imports_relocW7.exe", range: 140322..141346 },
	Entry { file_name: "imports_tinyW7.exe", range: 141346..142370 },
	Entry { file_name: "imports_tinyXP.exe", range: 142370..143394 },
	Entry { file_name: "imports_virtdesc.exe", range: 143394..144418 },
	Entry { file_name: "imports_vterm.exe", range: 144418..145442 },
	Entry { file_name: "ldrsnaps.exe", range: 145442..146466 },
	Entry { file_name: "ldrsnaps64.exe", range: 146466..148002 },
	Entry { file_name: "lowaldiff.exe", range: 148002..152354 },
	Entry { file_name: "lowsubsys.exe", range: 152354..153378 },
	Entry { file_name: "manifest.exe", range: 153378..154914 },
	Entry { file_name: "manifest_broken.exe", range: 154914..155938 },
	Entry { file_name: "manifest_bsod.exe", range: 155938..157986 },
	Entry { file_name: "maxsecXP.exe", range: 157986..162409 },
	Entry { file_name: "maxvals.exe", range: 162409..163433 },
	Entry { file_name: "memshared-ld.exe", range: 163433..164457 },
	Entry { file_name: "memshared.dll", range: 164457..165481 },
	Entry { file_name: "mini.exe", range: 165481..165809 },
	Entry { file_name: "mscoree.exe", range: 165809..166833 },
	Entry { file_name: "multiss.exe", range: 166833..168369 },
	Entry { file_name: "multiss_con.exe", range: 168369..169905 },
	Entry { file_name: "multiss_drv.sys", range: 169905..171441 },
	Entry { file_name: "multiss_gui.exe", range: 171441..172977 },
	Entry { file_name: "mz.exe", range: 172977..174001 },
	Entry { file_name: "namedresource.exe", range: 174001..175025 },
	Entry { file_name: "normal.exe", range: 175025..176049 },
	Entry { file_name: "normal64.exe", range: 176049..177073 },
	Entry { file_name: "nosectionW7.exe", range: 177073..177649 },
	Entry { file_name: "nosectionXP.exe", range: 177649..178216 },
	Entry { file_name: "nothing-ld.exe", range: 178216..179240 },
	Entry { file_name: "nothing.dll", range: 179240..180024 },
	Entry { file_name: "no_dd.exe", range: 180024..181048 },
	Entry { file_name: "no_dd64.exe", range: 181048..182072 },
	Entry { file_name: "no_dep.exe", range: 182072..183096 },
	Entry { file_name: "no_seh.exe", range: 183096..184120 },
	Entry { file_name: "nullEP.exe", range: 184120..185144 },
	Entry { file_name: "nullSOH-XP.exe", range: 185144..185727 },
	Entry { file_name: "nullvirt.exe", range: 185727..186751 },
	Entry { file_name: "ownexports.exe", range: 186751..187775 },
	Entry { file_name: "ownexports2.exe", range: 187775..188799 },
	Entry { file_name: "ownexportsdot.exe", range: 188799..189823 },
	Entry { file_name: "pdf.exe", range: 189823..190575 },
	Entry { file_name: "pdf_zip_pe.exe", range: 190575..191618 },
	Entry { file_name: "quine.exe", range: 191618..199992 },
	Entry { file_name: "reloc4.exe", range: 199992..201016 },
	Entry { file_name: "reloc9.exe", range: 201016..202040 },
	Entry { file_name: "reloccrypt.exe", range: 202040..204088 },
	Entry { file_name: "reloccryptW8.exe", range: 204088..206136 },
	Entry { file_name: "reloccryptXP.exe", range: 206136..209208 },
	Entry { file_name: "relocOSdet.exe", range: 209208..213816 },
	Entry { file_name: "relocsstripped.exe", range: 213816..214840 },
	Entry { file_name: "relocsstripped64.exe", range: 214840..215864 },
	Entry { file_name: "reshdr.exe", range: 215864..216888 },
	Entry { file_name: "resource.exe", range: 216888..217912 },
	Entry { file_name: "resource2.exe", range: 217912..218936 },
	Entry { file_name: "resourceloop.exe", range: 218936..219960 },
	Entry { file_name: "resource_icon.exe", range: 219960..227128 },
	Entry { file_name: "resource_string.exe", range: 227128..228664 },
	Entry { file_name: "safeseh.exe", range: 228664..229688 },
	Entry { file_name: "safeseh_fly.exe", range: 229688..230712 },
	Entry { file_name: "sc.exe", range: 230712..230980 },
	Entry { file_name: "secinsec.exe", range: 230980..233028 },
	Entry { file_name: "seh_change64.exe", range: 233028..234052 },
	Entry { file_name: "shuffledsect.exe", range: 234052..235588 },
	Entry { file_name: "signature.exe", range: 235588..238788 },
	Entry { file_name: "skippeddynbase.exe", range: 238788..239812 },
	Entry { file_name: "slackspace.exe", range: 239812..241860 },
	Entry { file_name: "ss63.exe", range: 241860..242884 },
	Entry { file_name: "ss63nocookie.exe", range: 242884..243908 },
	Entry { file_name: "standard.exe", range: 243908..254788 },
	Entry { file_name: "tiny.exe", range: 254788..255056 },
	Entry { file_name: "tinydll-ld.exe", range: 255056..256080 },
	Entry { file_name: "tinydll.dll", range: 256080..256364 },
	Entry { file_name: "tinydllXP-ld.exe", range: 256364..257388 },
	Entry { file_name: "tinydllXP.dll", range: 257388..257485 },
	Entry { file_name: "tinydrivXP.sys", range: 257485..257582 },
	Entry { file_name: "tinygui.exe", range: 257582..257850 },
	Entry { file_name: "tinynet.exe", range: 257850..259386 },
	Entry { file_name: "tinyW7.exe", range: 259386..259638 },
	Entry { file_name: "tinyW7x64.exe", range: 259638..259906 },
	Entry { file_name: "tinyW7_3264.exe", range: 259906..260174 },
	Entry { file_name: "tinyXP.exe", range: 260174..260271 },
	Entry { file_name: "tls.exe", range: 260271..261295 },
	Entry { file_name: "tls64.exe", range: 261295..262319 },
	Entry { file_name: "tls_aoi.exe", range: 262319..263343 },
	Entry { file_name: "tls_aoiOSDET.exe", range: 263343..264367 },
	Entry { file_name: "tls_exiting.exe", range: 264367..265391 },
	Entry { file_name: "tls_import.exe", range: 265391..266415 },
	Entry { file_name: "tls_k32.exe", range: 266415..267439 },
	Entry { file_name: "tls_noEP.exe", range: 267439..268463 },
	Entry { file_name: "tls_obfuscation.exe", range: 268463..269487 },
	Entry { file_name: "tls_onthefly.exe", range: 269487..270511 },
	Entry { file_name: "tls_reloc.exe", range: 270511..271535 },
	Entry { file_name: "tls_virtEP.exe", range: 271535..272559 },
	Entry { file_name: "truncatedlast.exe", range: 272559..273610 },
	Entry { file_name: "truncsectbl.exe", range: 273610..274634 },
	Entry { file_name: "version_cust.exe", range: 274634..275658 },
	Entry { file_name: "version_mini.exe", range: 275658..276682 },
	Entry { file_name: "version_std.exe", range: 276682..278730 },
	Entry { file_name: "virtEP.exe", range: 278730..279754 },
	Entry { file_name: "virtgap.exe", range: 279754..281290 },
	Entry { file_name: "virtrelocXP.exe", range: 281290..281894 },
	Entry { file_name: "virtsectblXP.exe", range: 281894..282478 },
	Entry { file_name: "weirdsord.exe", range: 282478..287110 },
	Entry { file_name: "winver.exe", range: 287110..288134 },
];
